import { Meta } from '@storybook/blocks';

<Meta title="Documentation/Components" />

# Working with SL Web Components Components, Pages, and Recipes

This codebase contains all the components, [recipes](https://bradfrost.com/blog/post/design-system-components-recipes-and-snowflakes/), and pages to successfully build the presentation view of product screens.

---

## Creating a component guidelines:

### Initializing Component Creation:
- Run `yarn workspace sl-web-components plop` for web components and `yarn workspace sl-react plop` for React components.
- Use dash-case for web components (e.g., my-web-component) and PascalCase for React components (e.g., MyReactComponent).
- After using templates, start Storybook by running `yarn workspace sl-web-components start`.

### Defining Properties:
- Define properties that form the component's structure, typically `string`, `boolean`, or `number`.
- Make properties required by omitting the `?` if they are integral to the component's functionality.

### HTML Structure:
- Construct the HTML structure of the component.
- Prioritize slot usage to ensure full composability, allowing dynamic content addition.
- Embed necessary components within the structure (e.g., a close button) if essential.

### Styling with SCSS and Tokens:
- Use Tier 2 tokens for styling with SCSS.
- Workflow for new tokens added via Figma:
- Push token studio changes to the `tokens` branch.
- Create a PR from the tokens branch to master, merge upon approval.
- Run `yarn workspace sl-web-components build:tokens` to update tokens in Storybook docs.

### Event Handling:
- Implement event handlers within the component as necessary.
- Prefix method names with 'handle' or 'set' based on their actions to maintain consistency.
- Avoid using event names (onClick, onHover) that may conflict with React's built-in methods.

### Documentation:
- Ensure comprehensive documentation for the component.
- Utilize basic Markdown formatting for clear and structured documentation.
- Refer to the Markdown Guide Cheat Sheet for formatting assistance.

### Building Web Component:
- Upon completing the main Web Component, run `yarn workspace sl-web-components build`.
- This command packages the WC files for the React wrappers to reference.
- For any subsequent changes in the WC, rerun the build command to reflect updates in React.

---

## Working with components

### Using components

Using SL Web Components components in your application involves first installing the SL Web Components package as a dependency:

[TODO] Process needs to be established

Next, import any needed components from the SL Web Components component library into your application like so:

1. **Auto-registering components method** (preferred) - This will automatically register the component by just importing the component. This is the preferred method of importing components. In order to trigger this auto registery you will need to set a global at the application level.

```js
// Set once at the application level
window.enAutoRegistry = true;
```

```js
// Now in your application you can import the component and it will be auto registered
import 'sl-web-components/dist/sl/components/button/button';
```

2. **Manual registering components method** - This method is necessary when using multiple versions of the SL Web Components given the global scope of custom elements registry. You'll need to use named imports to import the component and then manually register the component(s) using the `register` function available in the package. This method is not recommended unless you are using multiple versions of the SL Web Components in your application such as needed with a Micro Frontend Architecture.

```js
import { EnButton } from 'sl-web-components/dist/sl/components/button/button';
import { SLIconChevronRight } from 'sl-web-components/dist/components/icon/icons/chevron-right';
import register from 'sl-web-components/dist/directives/register';

...

/*
 * Register the component(s) with the register function.
 * @param {({ elements: [string, any] | [string, any][]; prefix?: string; suffix?: string })} { elements, prefix, suffix }
 * @return {*}
 *
 * Note: You can use the returned JS Map to alias the component with the default element name available at `SLButton.el`
 *
 * 'sl-button' -> 'sl-button-nav-bar'.
 *
 * The suffix & prefix parameters are optional and will be appended or preppended to the element name thus making the component namespace unique in the global scope.
*/
const elementMap = register({
  elements: [
    [SLButton.el, SLButton],
    [SLIconChevronRight.el, SLIconChevronRight],
  ],
  suffix: 'nav-bar' // Used to make the component namespace unique in the global scope
});
```

From there, call SL Web Components in your application and pass in the desired values into each component's API:

```html
<!-- Using auto register method or default element name -->

<sl-button variant="primary">
  Submit
  <sl-icon-chevron-right slot="after"></sl-icon-chevron-right>
</sl-button>

<!-- Using manual register method -->

// Using the unique component directly
<sl-button-nav-bar>Go</sl-button-nav-bar>

// Using the component alias via the map
`<${elementMap.get(SLButton.el)}>Go</${elementMap.get(SLButton.el)}>`
```

The last step is to import the theme CSS file into your application. This will provide the default styling for all components. There are two main ways to accomplish this:

1. **Importing the CSS file directly** - This method is recommended when it isn't necessary to support multiple version of the SL Web Components in your application. You'd import the CSS file into your application's main entry point (e.g. `index.js` or `main.js`) or main css file.

```js
import 'sl-web-components/dist/sl/sl.css';
```

```css
@import '~sl-web-components/dist/sl/sl.css';
```

2. **Using the scopeStyles function** - This method is recommended when using multiple versions of the SL Web Components in your application such as needed with a Micro Frontend Architecture. This approach will scope the CSS to the element selector provided.

```js
import { scopeStyles } from 'sl-web-components/dist/sl/directives/scope-styles';

...

// This will scope the CSS to the element name provided
const scopedCss = scopeStyles('#app'); // #app is the selector of the root element in your application (e.g. <div id="app"></div>)
// Add the syles to the DOM
const style = document.createElement('style');
style.type = 'text/css';
style.innerHTML = scopedCss;
document.head.appendChild(style);
```

Each SL Web Components component is documented in Storybook, which surfaces each component's API and provides copy-and-paste code snippets. If you have questions or are experiencing any issues when working with SL Web Components's components, please [reach out for support](#) (TODO: provide support link) and the team will be happy to help.

### Creating a component

1. To create a component, run `npm run plop` in the command line.
2. The command will ask, "What is your component name?" Add your component name (you can either type `link-list` or `link list` and it will automatically generate the proper casing).
3. In `packages/web-components/components/[component]/[component].stories.ts`, change `title: 'Molecules/Category/[ComponentName]'` to the location in the Storybook navigation where you want your component to live. For instance, `PageHeader` component you would change `title: 'Molecules/Category/PageHeader'` to `title: 'Molecules/Text/PageHeader'`.
4. Edit component source code in accordance with [SL Web Components's code guidelines](./CODE_GUIDELINES.md)
5. Create relevant stories for all component variants

---

## Working with recipes

**[Recipes](https://bradfrost.com/blog/post/design-system-components-recipes-and-snowflakes/)** are mainly compositions of design system components that are to be consistently used across a product, but arenâ€™t agnostic enough to live in core component library. Like pages, recipes live in the `.storybook` directory of the project since they are not packaged up with the design system. Recipe components may be revisited and pulled into [Name of design system] at a later date if they are deemed to be reusable enough to move into the design system library.

### Using recipes

TODO: Need to establish the location of where recipes should live. Options include:

1. The downstream application codebase
2. A `design-system-extras` sibling repository
3. In a directory in the `SL Web Components` library (not recommended)

### Creating a recipe

1. Run `plop recipe` in the command line.
2. Provide a name when asked "What is your recipe name?"
3. Plop will generate a recipe and accompanying stories file at `./storybook/recipes/[your-recipe-name]/[your-recipe-name].ts`
4. Begin editing the recipe, importing any necessary components and other recipes.
5. Create relevant stories for all recipe variants

Note: Recipe components live in `.storybook/recipes` and take the following shape in Storybook:

```
Recipes
--Component Name
----Component Stories
```

Recipe components should _not_ include the `.sl-` CSS prefix, since they are not part of the design system (so a recipe could look like `.c-recipe-name`). However, the other design system [code conventions](./CODE_GUIDELINES.md) should be followed in order to make refactoring into the design system as easy as possible.

---

## Directory structure <a name="directory"></a>

### Organizing components

We're using the [atomic design methodology](https://atomicdesign.bradfrost.com/chapter-2/#the-atomic-design-methodology) to cluster design system components into [Atoms](http://atomicdesign.bradfrost.com/chapter-2/#atoms), [Molecules](http://atomicdesign.bradfrost.com/chapter-2/#molecules), and [Organisms](http://atomicdesign.bradfrost.com/chapter-2/#organisms). Therefore the top-level navigation categories for Storybook are:

- Design tokens
- Atoms
- Molecules
- Organisms

The component stucture is as follows:

```
Atoms
--Design Tokens
--Component Category
----Component Name
------Component Stories
Molecules
--Component Category
----Component Name
------Component Stories
Organisms
--Component Category
----Component Name
------Component Stories
```

Components all follow a general pattern of:

```
--Component Category
----Individual Component Name
------Individual Component Stories
```

For instance, `Molecules/Buttons/Button` would look something like:

```
Molecules
--Buttons
----Button
------Default
------Primary
------Small
------[Other Variations]
```

---

## Testing

- [Documentation](https://storybook.js.org/docs/writing-tests/interaction-testing)