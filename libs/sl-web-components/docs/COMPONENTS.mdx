import { Meta } from '@storybook/blocks';

<Meta title="Documentation/Components" />

# Components

- [Creating Components](#creating-components)
- [Using Components](#using-components)

## Creating Components <a name="creating-components"></a>

### Initializing Component Creation
- Run `yarn workspace sl-web-components plop` for web components and `yarn workspace sl-react plop` for React components.
- Use dash-case for web components (e.g., my-web-component) and PascalCase for React components (e.g., MyReactComponent).
- After ploping the templates, start Storybook by running `yarn workspace sl-web-components start`.

### Defining Properties
- Define properties that form the component's structure, typically `string`, `boolean`, or `number`.

### HTML Structure
- Construct the HTML structure of the component. See the [code guidelines here](/docs/documentation-code-guidelines--docs#html).
- Prioritize slot usage to ensure full composability, allowing dynamic content addition.
- Embed necessary components within the structure (e.g., a close button) if essential.

### Styling with SCSS and Tokens
- Use Tier 2 tokens for styling with SCSS. See the [code guidelines here](/docs/documentation-code-guidelines--docs#css).
- Workflow for new tokens added via Figma:
  - Push token studio changes to the `figma-tokens` branch.
  - Create a PR from the tokens branch to master, merge upon approval.
- Run `yarn workspace sl-web-components build:tokens` to update tokens in Storybook docs.

### Event Handling
- Implement event handlers within the component as necessary. See the [code guidelines here](/docs/documentation-code-guidelines--docs#custom-events).
- Prefix method names with 'handle' or 'set' based on their actions to maintain consistency.
- Avoid using event names (onClick, onHover) that may conflict with React's built-in methods.

### Documentation
- Ensure comprehensive documentation for the component.
- Utilize basic Markdown formatting for clear and structured documentation.
- Refer to the Markdown Guide Cheat Sheet for formatting assistance.

### Packaging
- Upon completing the main Web Component, run `yarn workspace sl-web-components build`.
- This command packages the WC files for the React wrappers to reference.
- For any subsequent changes in the WC, rerun the build command to reflect updates in React.

## Using components <a name="using-components"></a>

Using Web Components components in your application involves first installing the Web Components package as a dependency:

Next, import any needed components from the Web Components component library into your application like so:

1. **Auto-registering components method** (preferred) - This will automatically register the component by just importing the component. This is the preferred method of importing components. In order to trigger this auto registery you will need to set a global at the application level.

```js
// Set once at the application level
window.slAutoRegistry = true;
```

```js
// Now in your application you can import the component and it will be auto registered
import 'sl-web-components/dist/components/button/button';
```

2. **Manual registering components method** - This method is necessary when using multiple versions of the Web Components given the global scope of custom elements registry. You'll need to use named imports to import the component and then manually register the component(s) using the `register` function available in the package. This method is not recommended unless you are using multiple versions of the Web Components in your application such as needed with a Micro Frontend Architecture.

```js
import { SLButton } from 'sl-web-components/dist/components/button/button';
import { SLIconChevronRight } from 'sl-web-components/dist/components/icon/icons/chevron-right';
import register from 'sl-web-components/dist/directives/register';

...

/*
 * Register the component(s) with the register function.
 * @param {({ elements: [string, any] | [string, any][]; prefix?: string; suffix?: string })} { elements, prefix, suffix }
 * @return {*}
 *
 * Note: You can use the returned JS Map to alias the component with the default element name available at `SLButton.el`
 *
 * 'sl-button' -> 'sl-button-nav-bar'.
 *
 * The suffix & prefix parameters are optional and will be appended or preppended to the element name thus making the component namespace unique in the global scope.
*/
const elementMap = register({
  elements: [
    [SLButton.el, SLButton],
    [SLIconChevronRight.el, SLIconChevronRight],
  ],
  suffix: 'nav-bar' // Used to make the component namespace unique in the global scope
});
```

From there, call Web Components in your application and pass in the desired values into each component's API:

```html
<!-- Using auto register method or default element name -->

<sl-button variant="primary">
  Submit
  <sl-icon-chevron-right slot="after"></sl-icon-chevron-right>
</sl-button>

<!-- Using manual register method -->

// Using the unique component directly
<sl-button-nav-bar>Go</sl-button-nav-bar>

// Using the component alias via the map
`<${elementMap.get(SLButton.el)}>Go</${elementMap.get(SLButton.el)}>`
```

The last step is to import the theme CSS file into your application. This will provide the default styling for all components. There are two main ways to accomplish this:

1. **Importing the CSS file directly** - This method is recommended when it isn't necessary to support multiple version of the Web Components in your application. You'd import the CSS file into your application's main entry point (e.g. `index.js` or `main.js`) or main css file.

```js
import 'sl-web-components/dist/css/head.css';
```

```css
@import '~sl-web-components/dist/css/head.css';
```

2. **Using the scopeStyles function** - This method is recommended when using multiple versions of the Web Components in your application such as needed with a Micro Frontend Architecture. This approach will scope the CSS to the element selector provided.

```js
import { scopeStyles } from 'sl-web-components/dist/directives/scope-styles';

...

// This will scope the CSS to the element name provided
const scopedCss = scopeStyles('#app'); // #app is the selector of the root element in your application (e.g. <div id="app"></div>)
// Add the syles to the DOM
const style = document.createElement('style');
style.type = 'text/css';
style.innerHTML = scopedCss;
document.head.appendChild(style);
```

Each Web Components component is documented in Storybook, which surfaces each component's API and provides copy-and-paste code snippets. If you have questions or are experiencing any issues when working with Web Components's components, feel free to contact the [Southleft team](https://southleft.com) for assistance.
